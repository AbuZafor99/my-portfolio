<!-- Experience Section -->
<section id="experience" class="experience">
    <h2 class="numbered-heading">Where I've Worked</h2>
    <div class="jobs-tabs">
        <ul class="tab-list slide-left" id="experienceTabs">
            <!-- Tabs will be loaded dynamically -->
        </ul>

        <div id="experienceContent">
            <!-- Experience content will be loaded dynamically -->
            <div class="loading-skeleton">
                <p style="color: #8892b0;">Loading experience...</p>
            </div>
        </div>
    </div>
</section>

<script src="js/api.js"></script>
<script>
// Load experience dynamically
async function loadExperience() {
    const tabsList = document.getElementById('experienceTabs');
    const contentDiv = document.getElementById('experienceContent');
    
    try {
        const experiences = await PortfolioAPI.getExperience();
        
        if (experiences.length === 0) {
            contentDiv.innerHTML = '<p style="color: #8892b0;">No experience available.</p>';
            return;
        }
        
        // Create tabs
        tabsList.innerHTML = '';
        experiences.forEach((exp, index) => {
            const li = document.createElement('li');
            li.className = `tab-button ${index === 0 ? 'active' : ''}`;
            li.textContent = exp.tabName;
            li.onclick = () => openTab(exp.id);
            tabsList.appendChild(li);
        });
        
        // Create content
        contentDiv.innerHTML = '';
        experiences.forEach((exp, index) => {
            const div = document.createElement('div');
            div.id = `job${exp.id}`;
            div.className = 'job-content slide-right';
            div.style.display = index === 0 ? 'block' : 'none';
            
            div.innerHTML = `
                <h3>
                    ${exp.position}
                    <span>@ ${exp.company}</span>
                </h3>
                <p class="range">${exp.period}</p>
                <ul class="job-desc">
                    ${exp.description.map(desc => `<li>${desc}</li>`).join('')}
                </ul>
            `;
            
            contentDiv.appendChild(div);
        });
    } catch (error) {
        console.error('Failed to load experience:', error);
        contentDiv.innerHTML = '<p style="color: #f87171;">Failed to load experience. Please try again later.</p>';
    }
}

// Tab switching function
function openTab(jobId) {
    // Hide all job contents
    document.querySelectorAll('.job-content').forEach(content => {
        content.style.display = 'none';
    });
    
    // Remove active class from all tabs
    document.querySelectorAll('.tab-button').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Show selected job content
    const selectedJob = document.getElementById(`job${jobId}`);
    if (selectedJob) {
        selectedJob.style.display = 'block';
    }
    
    // Add active class to clicked tab
    event.target.classList.add('active');
}

// Load experience when the page loads
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadExperience);
} else {
    loadExperience();
}
</script>